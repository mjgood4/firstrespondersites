<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />


    <!-- add title -->
    <title>San Francisco Response Times</title>

    <!-- import required libraries here -->
    <script type="text/javascript" src="lib/d3.v5.min.js"></script>
    <script type="text/javascript" src="lib/d3-dsv.min.js"></script>
    <script type="text/javascript" src="lib/d3-geo-projection.v2.min.js"></script>
    <script type="text/javascript" src="lib/topojson.v2.min.js"></script>
    <script type="text/javascript" src="lib/d3-tip.min.js"></script>
    <script type="text/javascript" src="lib/d3-legend.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
            integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="lib/sb-admin-2.min.css">

    <link rel="stylesheet" href="lib/fa-all.min.css">

    <script type="text/javascript" src="lib/sb-admin-2.min.js"></script>

    <style>
        body {
            margin: 40px;
      color: black;
    }

    #visualization_help li {
      margin-top: 20px;
    }

    small {
      color: #888;
        }

    .data_value {
      margin-left: 25px;
      display: inline-block;
        }

    /* Source: https://www.w3schools.com/css/css_tooltip.asp */
    .simple_tooltip {
            position: relative;
      display: inline-block;
      text-decoration: underline blue;
      /* If you want dots under the hoverable text */
        }

    small.simple_tooltip {
      color: blue;
      cursor: pointer;
        }

    /* Tooltip text */
    .simple_tooltip .tooltiptext {
      visibility: hidden;
      width: 300px;
      background-color: white;
      border: 1px solid lightblue;
      color: #333;
      text-align: left;
      padding: 5px;
      border-radius: 3px;
            position: absolute;
      z-index: 1;
        }

    /* Show the tooltip text when you mouse over the tooltip container */
    .simple_tooltip:hover .tooltiptext {
      visibility: visible;
        }
    </style>
</head>

<body>
<!-- Add heading for the visualization -->
  <h1 style="color: #0e95ef;">San Francisco: Where to build a new fire station?</h1>

<!-- https://gridbyexample.com/examples/example16/ -->
<div class="wrapper container-fixed" style="padding-top: 50px;">
    <table>
        <tr>
            <td style="min-width: 500px; vertical-align: top;">
                <div class="shadow" style="padding: 20px 10px;">
            <b style="font-size: 18pt; padding-right: 5px;"><i style="font-size: 20pt;"
                class="fa-solid fa-sliders-h"></i> Current Visualization:</b>
            <select>
              <option value="sim">New Firestation Simulation</option>
              <option value="supply">Supply</option>
              <option value="demand">Demand</option>
              </select>
              <div id="controls_spatial_accessibility" style="padding: 20px 10px;">
              <div id="visualization_help" style="font-size: 14pt; max-width: 600px;">
                <i class="fa-solid fa-circle-question" style="color: blue; font-size: 20px;"></i>
                <span style="color: blue;">How to use this visualization:</span>
                <ul>
                  <li>This visualization allows you to <b>simulate</b> the placement of a new fire station in San
                    Francisco. <small>The visualization uses the results of the Kernel Density Estimation and the
                      Two-Step Floating Catchment Area (2SFCA) algorithm.</small></li>
                  <li><b>Hover</b> over the map to see the estimated area the fire station could respond to in under 5
                    minutes, if a new station is placed in that area.
                    <br><small>The estimated area shown is sourced from the BingMaps API. Note that proximity to
                      interstates and highways will greatly affect the size and shape of this area.</small>
                  </li>
                  <li><b>Click</b> the map to simulate placing a fire station at that location.
                    <small>The size of the impact (colors) is determined by the 2SFCA algorithm. The data is precomputed
                      in the Python notebooks created for this project.</small>
                    <br>
                  </li>
                </ul>
                        </div>
                        <div id="simulation_controls">
                            <br>
                            <b>Simulation Type</b>
                            <form class="border" style="padding: 10px 10px;">
                                <input type="radio" name="simulation_type" value="sa" checked>
                                <label>Spatial Accessibility</label>
                                <br>
                                <input type="radio" name="simulation_type" value="rt">
                                <label>Response Time</label>
                            </form>
                        </div>
                        <br/>
              <button id="reset_fca" style="font-size: 14pt; float: right;"><i class="fa-solid fa-undo"
                  style="font-size: 20px;"></i> Reset Visualization</button>
                </div>
                </div>
          <div class="shadow" style="margin-top: 20px; padding: 10px 10px;">
            <b style="font-size: 18pt; padding-right: 5px;"><i style="font-size: 20pt;" class="fa-solid fa-map"></i> Map
              Legend</b>
            <div id="visualization_legend"></div>
                </div>
            </td>
            <td>
                <div id="visualization" class="shadow"
                     style="margin-left: 50px; width: 1300px; padding-left: 20px;"></div>
          <div id="visualization" class="shadow" style="margin-left: 20px; width: 1300px; padding: 20px 0px;">
            <div style="padding-left: 50px;">
              <b style="font-size: 12pt; padding-right: 5px;"><i style="font-size: 12pt;"
                  class="fa-solid fa-mouse-pointer"></i> Data for location</b><small>(based on 2019)</small>
              <br>
              <div class="data_value">
                # Daily fire incidents
                <small class="simple_tooltip">
                  (info)
                  <span class="tooltiptext">
                    Average number of daily incidents at the location, which required a fire truck or fire engine to
                    respond.
                  </span>
                </small>:
                <span id="daily_fire_incidents" class="val">-</span>
              </div>
              <div class="data_value">
                # Fire stations within 5 minutes
                <small class="simple_tooltip">
                  (info)
                  <span class="tooltiptext">
                    Number of fire stations that can respond with a truck or engine within 5 minutes.
                    This is provided by kernel density estimates for each fire station to understand the geographic
                    region
                    each can respond to in under 5 minutes (with high probability).
                  </span>
                </small>:
                <span id="num_fire_stations" class="val">-</span>
              </div>
              <div class="data_value">
                # Fire stations per incident
                <small class="simple_tooltip">
                  (info)
                  <span class="tooltiptext">
                    Ratio of the number of fire stations with 5 minutes to daily incidents.
                  </span>
                </small>:
                <span id="num_fire_stations_vs_incidents" class="val">-</span>
              </div>
              <br>
              <div class="data_value">
                Spatial Accessibility (current)
                <small class="simple_tooltip">
                  (info)
                  <span class="tooltiptext">
                    Results of the 2SFCA algorithm.  Unlike the ratio of fire stations to incidents, this
                    estimate considers if nearby zones ALSO have high incident rates and therefore fewer fire stations are available to respond.
                  </span>
                </small>:
                <span id="accessibility_score" class="val">-</span>
              </div>
              <div class="data_value">
                Spatial Accessibility (new)
                <small class="simple_tooltip">
                  (info)
                  <span class="tooltiptext">
                    Results of the 2SFCA algorithm applied to the simulation, when a new fire station is placed in the selected square.
                  </span>
                </small>:
                <span id="accessibility_score_sim" class="val">-</span>
              </div>
              <div class="data_value">
                % increase spatial accessibility
                <small class="simple_tooltip">
                  (info)
                  <span class="tooltiptext">
                    The increase in spatial accessibilty under the simulation
                  </span>
                </small>:
                <span id="accessibility_score_increase" class="val">-</span>
              </div>
            </div>

          </div>
            </td>
        </tr>
    </table>
</div>

<!-- d3 code below -->
<script src="map_vis.js"></script>

</body>

</html>